<html>
    <head>
        <meta charset="UTF_8">
        <link rel="stylesheet" href="CSS/all.css">
        <link rel="stylesheet" href="CSS/style.css">
    </head>
 <body>
    <header>
        <div class="header-container">
            <div class="icon">
                <i class="fa-solid fa-book-open"></i>
                <h2>LibraHub</h2>
            </div>
            <div class="heah_link">
                <p class="search-p">Admin Panel</p>
                <a href="dashbord.html" class="serch-links a-login"><button class="dash-btn search-buuton">Dashboard</button></a>
                <a href="search.html" class="serch-links a-login"><button class="dash-btn search-buuton">Search</button></a>
                <a href="add.html" class="serch-links a-register"><button class="search-buuton">Add Book</button></a>
                <a href="#" class="serch-links a-register"><button class="search-buuton" style="background-color: #5a189a;">Add User</button></a>
                <a href="index.html" class="serch-links a-register"><button class="log-out-btn search-buuton">Log out <i class="fa-solid fa-right-from-bracket"></i></button></a>
            </div>
        </div>
    </header>

    <section class="sec-login">
        <div class="log-form">
            <div class="log-content">
                <i class="fa-solid fa-book-open"></i>
                <h2>LibraHub</h2>
                <p class="p-login">Add User</p>
            </div>
            <div class="log-input">
                <label>User Name</label>
                <input type="text" id="userName" placeholder="username...">
                
                <label>Email</label>
                <input class="pas-input" type="email" id="userEmail" placeholder="email...">
                
                <button id="submitBtn" class="log-submit">Add User</button>
                <p class="p-tohome"><a href="dashbord.html">Back to Home</a></p>
            </div>
        </div>
    </section>

    <script>
        document.getElementById('submitBtn').addEventListener('click', async function () {
            // Get data from inputs
            const name = document.getElementById('userName').value;
            const email = document.getElementById('userEmail').value;

            // Simple check
            if (!name || !email) {
                alert("Please fill in both name and email");
                return;
            }

            // The data object must match the AddMember class properties
            const userData = {
                name: name,
                email: email
            };

            try {
                // Change the URL to match your actual backend URL (e.g., https://localhost:7000)
                const response = await fetch('http://localhost:5042/api/Member/AddMember', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(userData)
                });

                if (response.ok) {
                    const result = await response.json();
                    alert("User added successfully!");
                    // Clear inputs
                    document.getElementById('userName').value = '';
                    document.getElementById('userEmail').value = '';
                } else {
                    const errorMsg = await response.text();
                    alert("Error: " + errorMsg);
                }
            } catch (error) {
                console.error("Connection Error:", error);
                alert("Could not connect to the server. Check if the API is running.");
            }
        });
    </script>
</body>
</html>